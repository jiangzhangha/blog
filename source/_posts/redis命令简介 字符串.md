---
title: redis命令简介 字符串
date: 2020-07-08 13:36:45
categories: redis
index_img: /img/articles/redis.jpg
tags:
	- redis
	- 字符串
	- string
---

# 字符串

## set

**作用**：为字符串键设置值

**格式**：`set key value`

**扩展**：

从2.6.12版本开始，用户可以通过向`set`命令提供可选的`NX`选项或者`XX`选项，来指示`set`命令是否需要覆盖一个已经存在的值。

`set key value [NX | XX]`

如果用户在执行`set`命令时给定了`NX`选项，则只会在键没有值的情况下执行设置操作，返回OK表示设置成功。如果键已经存在，那么`set`命令将放弃执行操作，并返回空值`nil`表示设置失败。

如果用户在执行`set`命令时给定了`XX`选项，则只会在键已经有值的情况下执行设置操作，返回OK表示设置成功。如果键并没有值，那么`set`命令将放弃执行操作，并返回空值`nil`表示设置失败。



## get

**作用**：获取字符串键的值

**格式**：`get key`



## getset

**作用**：获取字符串键目前已有的值，接着为键设置新值，然后将之前获取的旧值返回给用户

**格式**：`getset key new_value`

如果被设置的键并不存在于数据库，则`getset`命令将返回空值（`nil`）作为键的旧值。



## mset

**作用**：一次为多个字符串键设置值

**格式**：`mset key value [key value ...]`



## mget

**作用**：一次获取多个字符串键的值

**格式**：`mget key [key ...]`



## msetnx

**作用**：只在键不存在的情况下，一次为多个字符串键设置值

**格式**：`msetnx key value [key value ...]`

**扩展**：

`msetnx`只会在所有给定的键都不存在的情况下，才对键进行设置。如果给定的键当中，即使有一个键已经存在值，命令`msetnx`也会放弃对所有给定的键的设置操作。

命令`msetnx`成功执行设置操作时返回1，放弃执行设置操作时返回0



## strlen

**作用**：获取字符串键存储的值的字节长度

**格式**：`strlen key`

**扩展**：

对于不存在的键，命令将返回0



## getrange

**作用**：获取字符串键存储的值指定索引范围的内容，即获取字符串值从`start`索引开始，直到`end`索引为止的所有内容

**格式**：`getrange key start end`

**扩展**：

每个字符串都是由一系列的字节组成，每个字节实际上都拥有与之相对应的索引，`redis`提供的索引命令。允许用户通过正数索引或者负数索引，对字符串值的某个字节，或者某个部分进行处理。

1. 字符串值的正数索引以`0`开始，从字符串的开头向结尾不断递增
2. 字符串值的负值索引以`-1`开始，从字符串的结尾向开头不断递减

`getrange`命令接受的是闭区间索引范围，即位于`start`索引和`end`索引上的值也会被包含在命令返回的内容中。



## setrange

**作用**：对字符串的指定索引范围进行设置

**格式**：`setrange key index substitute`

**扩展**：

使用该命令，用户可以将字符串键的值，从索引`index`开始的部分，替换为指定的新内容`substitute`，被替换内容的长度取决于新内容的长度。

命令执行完设置操作后，会返回字符串值当前的长度。

当用户给定的新内容比被替换的内容更长时，命令将会自动扩展被修改的字符串值，从而确保新的内容可以被顺利写入。



## append

**作用**：将给定的内容追加到字符串键已有的值的末尾

**格式**：`append key suffix`

**扩展**：

命令执行完追加操作后，会返回字符串值当前的长度。

如果用户给定的键不存在，则命令会先将键的值初始化为空字符串，然后再执行追加操作，最终的效果与使用命令`set`类似。



## incrby & decrby

**作用**：当字符串键存储的值能够被`redis`解释为整数时，用户可以通过命令`incrby`对被存储的整数值执行加法操作，通过命令`decrby`对被存储的整数值执行减法操作。

**格式**：

`incrby key increment`

`decrby key increment`

**扩展**：

每当用户将一个值存储到字符串键值中时，`redis`会对该值进行检测，如果满足以下两个条件之一，则`redis`会将该值当作数字处理：

1. 能够使用`C`语言的`long long int`类型存储的整数；
2. 能够使用`C`语言的`long double`类型存储的整数。

当字符串键的值不能被`redis`解释为整数时，对键执行`incrby`或者`decrby`命令将返回一个错误。

另外，`incrby`或者`decrby`命令的增量与减量也必须能够被`redis`解释为整数，否则将返回一个错误。

当使用`incrby`或者`decrby`命令操作的键不存在时，命令会先将键的值初始化为0，然后再执行相应的加法或者减法操作。



## incr & decr

**作用**：对字符串键存储的整数值加1，或者减1

**格式**：

`incr key`

`decr key`



## incrbyfloat

**作用**：对字符串键存储的数字值执行浮点数加法操作

**格式**：`incrbyfloat key increment`

**扩展**：

命令可以把一个浮点数增量加到字符串键存储的数字值上，并返回执行加法操作后的数字值

命令在遇到不存在的键时，会先将键对应的值初始化为0，然后再执行相应的加法操作

**注意，`redis`没有为`incrbyfloat`命令提供相应的减法版本，因此用户只能通过给`incrbyfloat`命令传入负数增量来执行浮点数减法操作**

另外，命令具有如下的特点：

1. `incrbyfloat`命令既可用于浮点数值，也可用于整数值
2. `incrbyfloat`命令的增量既可以是浮点数，也可以是整数
3. 当`incrbyfloat`命令的执行结果可以表示为整数时，命令的执行结果将以整数形式存储
4. `incrbyfloat`命令的结果最多会保留小数点后的17位数字，超过这个范围的小数将被截断